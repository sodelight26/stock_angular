<div class="container">
  <div class="row">
    <div class="card border-light shadow-lg mt-3">
      <div class="card-body">
        <h5 class="fw-bold">
          <i class="fa-solid fa-cash-register"></i>
          การชำระเงิน
        </h5>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">หน้าแรก</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              การชำระเงิน
            </li>
          </ol>
        </nav>
      </div>
    </div>
    
    <div class="card border-light shadow-lg mt-3">
      <div class="card-body">
        <h5 class="text-muted fw-bold px-6 mb-3">สถานะการชำระเงิน</h5>
        <hr />
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active text-secondary fw-bold" id="pills-home-tab" data-bs-toggle="pill"
              data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home"
              aria-selected="true">รายการทั้งหมด</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link text-Info fw-bold" id="pills-profile-tab" data-bs-toggle="pill"
              data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile"
              aria-selected="false">รอดำเนินการ</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link text-success fw-bold" id="pills-contact-tab" data-bs-toggle="pill"
              data-bs-target="#pills-contact" type="button" role="tab" aria-controls="pills-contact"
              aria-selected="false">ชำระแล้ว</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link text-warning fw-bold" id="pills-disabled-tab" data-bs-toggle="pill"
              data-bs-target="#pills-disabled" type="button" role="tab" aria-controls="pills-disabled"
              aria-selected="false">ยังไม่ชำระ</button>
          </li>
        </ul>

        <div class="tab-content" id="pills-tabContent">


          <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab"
              tabindex="0">
              <div class="container mt-3">
                <div class="table-responsive">
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr class="table-primary">
                        <th scope="col">เลขที่บิล</th>
                        <th scope="col">ชื่อลูกค้า</th>
                        <th scope="col">วันที่สั่งซื้อ</th>
                        <th scope="col">สถานะ</th>
                        <th scope="col">ดูรายละเอียด</th>
                        <th scope="col">พิมพ์ใบเสร็จ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of dataview">
                        <td>{{ item.ORD_ID }}</td>
                        <td>{{ item.CUS_NAME }}</td>
                        <td>{{ item.ORD_DAT }}</td>
                        <td>
                          <span class="badge text-bg-{{ colr_name }}" *ngIf="checkProductStatus(item) !== ''">{{
                            checkProductStatus(item) }}</span>
                        </td>
                        <td>
                          <button type="button" class="btn btn-primary" data-bs-toggle="modal" (click)="updd(item)"
                            data-bs-target="#exampleModal1">
                            <i class="fa-solid fa-circle-info me-1"></i>
                            ดูรายละเอียด
                          </button>
                        </td>
                        <td>
                          <button *ngIf="item.ORD_STUS === '1'|| item.ORD_STUS === '2'" type="button"
                            class="btn btn-info" data-bs-toggle="modal" (click)="updd(item)"
                            data-bs-target="#exampleModal55">
                            <i class="fa-solid fa-print"></i>
                            พิมพ์
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab"
              tabindex="0">
              <div class="container mt-3">
                <div class="table-responsive">
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr class="table-primary">
                        <th scope="col">เลขที่บิล</th>
                        <th scope="col">ชื่อลูกค้า</th>
                        <th scope="col">วันที่สั่งซื้อ</th>
                        <th scope="col">สถานะ</th>
                        <th scope="col">ดูรายละเอียด</th>
                        <th scope="col">พิมพ์ใบเสร็จ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of dataview">
                        <ng-container *ngIf="item.ORD_STUS === '0'">
                          <td>{{ item.ORD_ID }}</td>
                          <td>{{ item.CUS_NAME }}</td>
                          <td>{{ item.ORD_DAT }}</td>
                          <td>
                            <span class="badge text-white bg-{{ colr_name }}" *ngIf="checkProductStatus(item) !== ''">
                              {{ checkProductStatus(item) }}
                            </span>
                          </td>
                          <td>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" (click)="updd(item)"
                              data-bs-target="#exampleModal1">
                              <i class="fa-solid fa-circle-info me-1"></i>
                              ดูรายละเอียด
                            </button>
                          </td>
                          <td>

                          </td>
                        </ng-container>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab"
              tabindex="0">
              <div class="container mt-3">
                <div class="table-responsive">
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr class="table-primary">
                        <th scope="col">เลขที่บิล</th>
                        <th scope="col">ชื่อลูกค้า</th>
                        <th scope="col">วันที่สั่งซื้อ</th>
                        <th scope="col">สถานะ</th>
                        <th scope="col">ดูรายละเอียด</th>
                        <th scope="col">พิมพ์ใบเสร็จ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of dataview">
                        <ng-container *ngIf="item.ORD_STUS === '1'">
                          <td>{{ item.ORD_ID }}</td>
                          <td>{{ item.CUS_NAME }}</td>
                          <td>{{ item.ORD_DAT }}</td>
                          <td>
                            <span class="badge text-white bg-{{ colr_name }}" *ngIf="checkProductStatus(item) !== ''">
                              {{ checkProductStatus(item) }}
                            </span>
                          </td>
                          <td>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" (click)="updd(item)"
                              data-bs-target="#exampleModal1">
                              <i class="fa-solid fa-circle-info me-1"></i>
                              ดูรายละเอียด
                            </button>
                          </td>
                          <td>
                            <button *ngIf="item.ORD_STUS === '1'" type="button" class="btn btn-info"
                              data-bs-toggle="modal" (click)="updd(item)" data-bs-target="#exampleModal55">
                              <i class="fa-solid fa-print"></i>
                              พิมพ์
                            </button>
                          </td>
                        </ng-container>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="tab-pane fade" id="pills-disabled" role="tabpanel" aria-labelledby="pills-disabled-tab"
              tabindex="0">
              <div class="container mt-3">
                <div class="table-responsive">
                  <table class="table table-striped table-hover">
                    <thead>
                      <tr class="table-primary">
                        <th scope="col">เลขที่บิล</th>
                        <th scope="col">ชื่อลูกค้า</th>
                        <th scope="col">วันที่สั่งซื้อ</th>
                        <th scope="col">สถานะ</th>
                        <th scope="col">ดูรายละเอียด</th>
                        <th scope="col">พิมพ์ใบเสร็จ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of dataview">
                        <ng-container *ngIf="item.ORD_STUS === '2'">
                          <td>{{ item.ORD_ID }}</td>
                          <td>{{ item.CUS_NAME }}</td>
                          <td>{{ item.ORD_DAT }}</td>
                          <td>
                            <span class="badge text-bg-{{ colr_name }}" *ngIf="checkProductStatus(item) !== ''">{{
                              checkProductStatus(item) }}</span>
                          </td>
                          <td>
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" (click)="updd(item)"
                              data-bs-target="#exampleModal1">
                              <i class="fa-solid fa-circle-info me-1"></i>
                              ดูรายละเอียด
                            </button>
                          </td>
                          <td>
                            <button *ngIf="item.ORD_STUS === '2'" type="button" class="btn btn-info"
                              data-bs-toggle="modal" (click)="updd(item)" data-bs-target="#exampleModal55">
                              <i class="fa-solid fa-print"></i>
                              พิมพ์
                            </button>
                          </td>
                        </ng-container>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>
</div>

<!-- Modal ดูรายละเอียดทั้งหมด -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header bg-primary">
        <h1 class="modal-title fs-5 fw-bold text-white" id="exampleModalLabel">
          <i class="fa-solid fa-circle-info me-1"></i>
          รายละเอียดการสั่งซื้อ
        </h1>
      </div>
      <div class="modal-body">
        <div class="card-body">
          <div class="row g-3 mt-1 border-light">
            <div class="row">
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-form-label fw-bold">เลขที่บิล</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                    [(ngModel)]="formdd.ORD_ID" />
                </div>
              </div>
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-form-label fw-bold">สถานะ</label>
                <div
                  [ngClass]="{'status-0': formdd.ORD_STUS=== '0', 'status-1': formdd.ORD_STUS === '1', 'status-2': formdd.ORD_STUS === '2'}">
                  {{formdd.STUS_NAME}}
                </div>
              </div>
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-form-label fw-bold">ชื่อลูกค้า</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                    [(ngModel)]="formdd.CUS_NAME" />
                </div>
              </div>
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-sm-10 col-form-label fw-bold">ที่อยู่</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control-plaintext" id="CUS_ADR"
                    [(ngModel)]="formdd.CUS_ADR" />
                </div>
              </div>
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-form-label fw-bold">ช่องทางการชำระ</label>
                <div class="col-sm-10 mt-1">
                  <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                    [(ngModel)]="formdd.STUS_TYPE" />
                </div>
              </div>
              <div class="col-md-5 row">
                <label for="staticEmail" class="col-form-label fw-bold">วันที่สั่งซื้อ</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                    [(ngModel)]="formdd.ORD_DAT" />
                </div>
              </div>
              <div class="col-md-2 row">
                <label for="staticEmail" class="col-form-label fw-bold">ผู้ขาย</label>
                <div class="col-sm-10">
                  <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                    [(ngModel)]="formdd.USER_NAME" />
                </div>
              </div>
            </div>
          </div>
          <div>
            <div style="overflow-x: auto">
              <table class="table mt-3">
                <thead>
                  <tr class="table-primary">
                    <th scope="col">รหัสสินค้า</th>
                    <th scope="col">ชื่อสินค้า</th>
                    <th scope="col">ประเภท</th>
                    <th scope="col">ไซส์</th>
                    <th scope="col">จำนวน</th>
                    <th scope="col">ราคาขาย</th>
                    <th scope="col">ราคารวม</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of formdd.datapay">
                    <td>{{ item.PRD_ID }}</td>
                    <td>{{ item.PRD_NAME }}</td>
                    <td>{{ item.TYPE_NAME }}</td>
                    <td>{{ item.SIZE_NAME }}</td>
                    <td>{{ item.ORDD_NUM }}</td>
                    <td>{{ item.ORDD_PRICE }}</td>
                    <td>{{ item.ORDD_NUM * item.ORDD_PRICE }}</td>
                  </tr>
                  <tr class="table-primary">
                    <th scope="row"></th>
                    <td colspan="4"></td>
                    <td class="table-active"></td>
                    <td class="table-active text-danger fw-bold">
                      ยอดรวม {{ calculateSum() }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="mt-4 text-end">
            <button *ngIf="formdd.ORD_TYPESELL === '1'&& formdd.STUS_NAME == 'รอดำเนินการ'" type="button"
              class="btn btn-primary me-3" name="ORD_ID" (click)="updatastus(this.formdd)">
              <i class="fa-solid fa-circle-check"></i>
              ยืนยันการชำระ
            </button>
            <button *ngIf="formdd.ORD_TYPESELL === '2' && formdd.ORD_STUS !== '2'&& formdd.STUS_NAME == 'รอดำเนินการ'"
              type="button" class="btn btn-primary me-3" name="ORD_ID" (click)="updatastus1(this.formdd)">
              <i class="fa-solid fa-circle-check"></i>
              ยืนยันการสั่งซื้อ
            </button>
            <button *ngIf="formdd.ORD_STUS === '2'" type="button" class="btn btn-primary me-3" name="ORD_ID"
              (click)="updatastus2(this.formdd)">
              <i class="fa-solid fa-circle-check"></i>
              ยืนยันการชำระเครดิต
            </button>

            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">
              <i class="fa-regular fa-circle-xmark"></i>
              ยกเลิก
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div #receiptElement>
  <div class="modal fade" id="exampleModal55" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content"  >
        <div class="modal-header bg-info">
          <div class="col-md-3">
            <select (change)="changselecttypesell($event)" [(ngModel)]="formdd.ORD_TYPENAME"
              class="form-select form-select-lg bg-info fw-bold border-0" aria-label=".form-select-lg example">
              <option *ngIf="formdd.ORD_TYPESELL === '1' && formdd.ORD_STUS === '1'" value="1">บิลเงินสด</option>
              <option *ngIf="formdd.ORD_STUS === '2'" value="2">บิลส่งของ</option>
              <option *ngIf="formdd.ORD_TYPESELL === '2' && formdd.ORD_STUS === '1'" value="3">ใบเสร็จรับเงิน</option>
            </select>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="card-body" id="pdfTable" #content>
            <div class="row g-3 mt-1 border-light" >
              <div class="row">
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-form-label fw-bold">เลขที่บิล</label>
                  <div class="col-sm-10">
                    <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                      [(ngModel)]="formdd.ORD_ID" />
                  </div>
                </div>
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-form-label fw-bold">สถานะ</label>
                  <div class="col-sm-10">
                    <span class="badge text-bg-{{ colr_name }}" *ngIf="checkProductStatus(formdd) !== ''">{{
                      checkProductStatus(formdd) }}</span>
                  </div>
                </div>
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-form-label fw-bold">ชื่อลูกค้า</label>
                  <div class="col-sm-10">
                    <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                      [(ngModel)]="formdd.CUS_NAME" />
                  </div>
                </div>
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-sm-10 col-form-label fw-bold">ที่อยู่</label>
                  <div class="col-sm-10">
                    <input type="text" readonly class="form-control-plaintext" id="CUS_ADR"
                      [(ngModel)]="formdd.CUS_ADR" />
                  </div>
                </div>
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-form-label fw-bold">ช่องทางการชำระ</label>
                  <div class="col-sm-10 mt-1">
                    <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                      [(ngModel)]="formdd.STUS_TYPE" />
                  </div>
                </div>
                <div class="col-md-5 row">
                  <label for="staticEmail" class="col-form-label fw-bold">วันที่สั่งซื้อ</label>
                  <div class="col-sm-10">
                    <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                      [(ngModel)]="formdd.ORD_DAT" />
                  </div>
                </div>
                <div class="col-md-2 row">
                  <label for="staticEmail" class="col-form-label fw-bold">ผู้ขาย</label>
                  <div class="col-sm-10">
                    <input type="text" readonly class="form-control-plaintext" id="staticEmail"
                      [(ngModel)]="formdd.USER_NAME" />
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div style="overflow-x: auto">
                <table class="table mt-3">
                  <thead>
                    <tr class="table-primary">
                      <th scope="col">รหัสสินค้า</th>
                      <th scope="col">ชื่อสินค้า</th>
                      <th scope="col">ประเภท</th>
                      <th scope="col">ไซส์</th>
                      <th scope="col">จำนวน</th>
                      <th scope="col">ราคาขาย</th>
                      <th scope="col">ราคารวม</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of formdd.datapay ">
                      <td>{{ item.PRD_ID }}</td>
                      <td>{{ item.PRD_NAME }}</td>
                      <td>{{ item.TYPE_NAME }}</td>
                      <td>{{ item.SIZE_NAME }}</td>
                      <td>{{ item.ORDD_NUM }}</td>
                      <td>{{ item.ORDD_PRICE }}</td>
                      <td>{{ item.ORDD_NUM * item.ORDD_PRICE}}</td>
                    </tr>
                    <tr class="table-primary">
                      <th scope="row"></th>
                      <td colspan="4"></td>
                      <td class="table-active"></td>
                      <td class="table-active text-danger fw-bold">
                        ยอดรวม {{ calculateSum() }}
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="mt-4 text-end">

              <button type="button" class="btn btn-info me-3" (click)="downloadPDF()">
                <i class="fa-solid fa-circle-check"></i>
                พิมพ์ใบเสร็จ
              </button>

              <button type="button" class="btn btn-danger" data-bs-dismiss="modal">
                <i class="fa-regular fa-circle-xmark"></i>
                ยกเลิก
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



